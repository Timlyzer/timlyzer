# å¾…å®ç°åŠŸèƒ½è®¾è®¡æ–‡æ¡£

> ğŸ“… åˆ›å»ºæ—¥æœŸ: 2026-01-01
> ğŸ“‹ ç‰ˆæœ¬: v1.0

æœ¬æ–‡æ¡£è¯¦ç»†æè¿° Timlyzer å¾…å®ç°åŠŸèƒ½çš„è®¾è®¡æ–¹æ¡ˆã€‚

---

## 1. æ•°æ®å¯¼å‡ºåŠŸèƒ½

### 1.1 åŠŸèƒ½æ¦‚è¿°

å…è®¸ç”¨æˆ·å°†è¿½è¸ªæ•°æ®å¯¼å‡ºä¸º CSV æˆ– JSON æ ¼å¼ï¼Œä¾¿äºæ•°æ®åˆ†æå’Œå¤‡ä»½ã€‚

### 1.2 ç”¨æˆ·æ•…äº‹

> ä½œä¸ºç”¨æˆ·ï¼Œæˆ‘å¸Œæœ›èƒ½å¤Ÿå¯¼å‡ºæˆ‘çš„æ—¶é—´è¿½è¸ªæ•°æ®ï¼Œè¿™æ ·æˆ‘å¯ä»¥åœ¨ Excel ä¸­åˆ†ææˆ–å¤‡ä»½æˆ‘çš„æ•°æ®ã€‚

### 1.3 åŠŸèƒ½éœ€æ±‚

| ID    | éœ€æ±‚                          | ä¼˜å…ˆçº§ |
| ----- | ----------------------------- | ------ |
| EX-01 | å¯¼å‡ºä¸º CSV æ ¼å¼               | P1     |
| EX-02 | å¯¼å‡ºä¸º JSON æ ¼å¼              | P2     |
| EX-03 | è‡ªå®šä¹‰å¯¼å‡ºæ—¶é—´èŒƒå›´            | P1     |
| EX-04 | é€‰æ‹©å¯¼å‡ºç±»å‹ (App/Status/All) | P1     |
| EX-05 | æ–‡ä»¶ä¿å­˜å¯¹è¯æ¡†                | P1     |

### 1.4 æŠ€æœ¯è®¾è®¡

#### åç«¯ (Rust)

```rust
// src-tauri/src/commands.rs

/// å¯¼å‡ºæ•°æ®ä¸º CSV
#[tauri::command]
pub async fn export_to_csv(
    state: State<'_, AppState>,
    from: i64,
    to: i64,
    task_name: Option<String>,  // å¯é€‰è¿‡æ»¤
    file_path: String,
) -> Result<ExportResult, String>;

/// å¯¼å‡ºæ•°æ®ä¸º JSON
#[tauri::command]
pub async fn export_to_json(
    state: State<'_, AppState>,
    from: i64,
    to: i64,
    task_name: Option<String>,
    file_path: String,
) -> Result<ExportResult, String>;

#[derive(Serialize)]
pub struct ExportResult {
    pub success: bool,
    pub items_exported: i64,
    pub file_path: String,
}
```

#### å‰ç«¯ (TypeScript)

```typescript
// src/services/tauri-api.ts
export const exportApi = {
  exportToCsv: async (
    from: number,
    to: number,
    taskName?: string,
    filePath: string
  ) => Promise<ExportResult>,
  exportToJson: async (
    from: number,
    to: number,
    taskName?: string,
    filePath: string
  ) => Promise<ExportResult>,
};

// ä½¿ç”¨ Tauri æ–‡ä»¶å¯¹è¯æ¡†é€‰æ‹©ä¿å­˜ä½ç½®
import { save } from "@tauri-apps/api/dialog";
```

#### UI ç»„ä»¶

åœ¨è®¾ç½®é¡µé¢æˆ–æœç´¢é¡µé¢æ·»åŠ å¯¼å‡ºæŒ‰é’®ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Export Data                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Date Range: [Today â–¼] to [Today â–¼]  â”‚
â”‚ Type: [All â–¼]                       â”‚
â”‚ Format: â—‹ CSV  â—‹ JSON               â”‚
â”‚                                     â”‚
â”‚ [Cancel]              [Export]      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.5 CSV æ ¼å¼

```csv
id,app,title,taskName,beginDate,endDate,duration,color
1,"Google Chrome","GitHub","AppTrackItem",1735689600000,1735693200000,3600000,"#4285f4"
```

### 1.6 JSON æ ¼å¼

```json
{
  "exportDate": "2026-01-01T21:00:00Z",
  "dateRange": { "from": 1735689600000, "to": 1735776000000 },
  "totalItems": 100,
  "totalDuration": 28800000,
  "items": [
    { "id": 1, "app": "Google Chrome", ... }
  ]
}
```

---

## 2. çª—å£æœ€å°åŒ–åˆ°æ‰˜ç›˜

### 2.1 åŠŸèƒ½æ¦‚è¿°

å½“ç”¨æˆ·å…³é—­ä¸»çª—å£æ—¶ï¼Œåº”ç”¨ä¸é€€å‡ºè€Œæ˜¯æœ€å°åŒ–åˆ°ç³»ç»Ÿæ‰˜ç›˜ç»§ç»­åå°è¿è¡Œã€‚

### 2.2 ç”¨æˆ·æ•…äº‹

> ä½œä¸ºç”¨æˆ·ï¼Œå½“æˆ‘ç‚¹å‡»å…³é—­æŒ‰é’®æ—¶ï¼Œæˆ‘å¸Œæœ›åº”ç”¨æœ€å°åŒ–åˆ°æ‰˜ç›˜ç»§ç»­è¿½è¸ªï¼Œè€Œä¸æ˜¯å®Œå…¨é€€å‡ºã€‚

### 2.3 åŠŸèƒ½éœ€æ±‚

| ID    | éœ€æ±‚                                     | ä¼˜å…ˆçº§ |
| ----- | ---------------------------------------- | ------ |
| TR-01 | å…³é—­çª—å£æ—¶éšè—è€Œéé€€å‡º                   | P0     |
| TR-02 | æ‰˜ç›˜å›¾æ ‡å³é”®èœå•æ·»åŠ "çœŸæ­£é€€å‡º"é€‰é¡¹       | P0     |
| TR-03 | è®¾ç½®é€‰é¡¹ï¼šå…³é—­æ—¶è¯¢é—®/æ€»æ˜¯æœ€å°åŒ–/æ€»æ˜¯é€€å‡º | P1     |
| TR-04 | æ‰˜ç›˜æç¤ºæ˜¾ç¤ºå½“å‰çŠ¶æ€                     | P2     |

### 2.4 æŠ€æœ¯è®¾è®¡

#### åç«¯ (Rust)

```rust
// src-tauri/src/lib.rs
// åœ¨ window é…ç½®ä¸­è®¾ç½® close_requested äº‹ä»¶å¤„ç†

tauri::Builder::default()
    .on_window_event(|window, event| {
        if let tauri::WindowEvent::CloseRequested { api, .. } = event {
            // é˜»æ­¢é»˜è®¤å…³é—­è¡Œä¸º
            api.prevent_close();
            // éšè—çª—å£è€Œä¸æ˜¯å…³é—­
            window.hide().unwrap();
        }
    })
```

#### æ‰˜ç›˜èœå•æ›´æ–°

```rust
// src-tauri/src/tray.rs
let menu = Menu::with_items(app, &[
    &MenuItem::with_id(app, "open", "Open Timlyzer", true, None)?,
    &MenuItem::with_id(app, "summary", "Today's Summary", true, None)?,
    &MenuItem::with_id(app, "separator1", "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€", false, None)?,
    &MenuItem::with_id(app, "pause", "Pause Tracking", true, None)?,
    &MenuItem::with_id(app, "separator2", "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€", false, None)?,
    &MenuItem::with_id(app, "quit", "Quit Timlyzer", true, None)?,
])?;
```

### 2.5 ç”¨æˆ·äº¤äº’æµç¨‹

```
ç”¨æˆ·ç‚¹å‡»å…³é—­æŒ‰é’® (Ã—)
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ£€æŸ¥è®¾ç½®é€‰é¡¹      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
   â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
   â”‚         â”‚
   â–¼         â–¼
[æœ€å°åŒ–]   [è¯¢é—®ç”¨æˆ·]
   â”‚         â”‚
   â–¼         â–¼
éšè—çª—å£   æ˜¾ç¤ºå¯¹è¯æ¡†
ç»§ç»­è¿½è¸ª   "Continue in background?"
```

---

## 3. è®¾ç½®é¡µé¢å®Œå–„

### 3.1 åŠŸèƒ½æ¦‚è¿°

å®Œå–„è®¾ç½®é¡µé¢ï¼Œæä¾›è¿½è¸ªé…ç½®ã€å¤–è§‚è®¾ç½®ã€æ•°æ®ç®¡ç†ç­‰åŠŸèƒ½ã€‚

### 3.2 è®¾ç½®åˆ†ç±»

#### 3.2.1 é€šç”¨è®¾ç½® (General)

| è®¾ç½®é¡¹     | ç±»å‹ | é»˜è®¤å€¼   | è¯´æ˜               |
| ---------- | ---- | -------- | ------------------ |
| ä¸»é¢˜       | é€‰æ‹© | System   | Light/Dark/System  |
| å¼€æœºè‡ªå¯åŠ¨ | å¼€å…³ | false    | ç³»ç»Ÿå¯åŠ¨æ—¶è‡ªåŠ¨è¿è¡Œ |
| å…³é—­è¡Œä¸º   | é€‰æ‹© | minimize | minimize/ask/quit  |
| è¯­è¨€       | é€‰æ‹© | English  | ç•Œé¢è¯­è¨€           |

#### 3.2.2 è¿½è¸ªè®¾ç½® (Tracking)

| è®¾ç½®é¡¹   | ç±»å‹ | é»˜è®¤å€¼ | èŒƒå›´      | è¯´æ˜               |
| -------- | ---- | ------ | --------- | ------------------ |
| è½®è¯¢é—´éš” | æ•°å­— | 3      | 1-10 ç§’   | æ£€æµ‹æ´»åŠ¨çª—å£çš„é¢‘ç‡ |
| ç©ºé—²é˜ˆå€¼ | æ•°å­— | 5      | 1-30 åˆ†é’Ÿ | åˆ¤å®šä¸ºç©ºé—²çš„æ—¶é—´   |
| è¿½è¸ª URL | å¼€å…³ | false  | -         | æ˜¯å¦è®°å½•æµè§ˆå™¨ URL |

#### 3.2.3 åº”ç”¨é¢œè‰² (App Colors)

| åŠŸèƒ½           | è¯´æ˜                     |
| -------------- | ------------------------ |
| å·²è¿½è¸ªåº”ç”¨åˆ—è¡¨ | æ˜¾ç¤ºæ‰€æœ‰å·²è¿½è¸ªè¿‡çš„åº”ç”¨   |
| ä¿®æ”¹é¢œè‰²       | ç‚¹å‡»é¢œè‰²å—æ‰“å¼€é¢œè‰²é€‰æ‹©å™¨ |
| é‡ç½®é¢œè‰²       | æ¢å¤é»˜è®¤é¢œè‰²             |

#### 3.2.4 æ•°æ®ç®¡ç† (Data)

| åŠŸèƒ½       | è¯´æ˜                 |
| ---------- | -------------------- |
| å¯¼å‡ºæ•°æ®   | å¯¼å‡ºä¸º CSV/JSON      |
| æ¸…ç†æ•°æ®   | åˆ é™¤æŒ‡å®šæ—¥æœŸå‰çš„æ•°æ® |
| æ•°æ®åº“ä½ç½® | æ˜¾ç¤ºæ•°æ®åº“æ–‡ä»¶è·¯å¾„   |
| æ•°æ®åº“å¤§å° | æ˜¾ç¤ºå½“å‰å ç”¨ç©ºé—´     |

### 3.3 æŠ€æœ¯è®¾è®¡

#### è®¾ç½®æ•°æ®ç»“æ„

```typescript
// src/types/index.ts
interface AppSettings {
  // General
  theme: "light" | "dark" | "system";
  autoStart: boolean;
  closeAction: "minimize" | "ask" | "quit";
  language: string;

  // Tracking
  pollingInterval: number; // seconds
  idleThreshold: number; // seconds
  trackUrls: boolean;
}
```

#### åç«¯å‘½ä»¤

```rust
// src-tauri/src/commands.rs

#[tauri::command]
pub fn get_settings(state: State<AppState>) -> Result<AppSettings, String>;

#[tauri::command]
pub fn save_settings(
    state: State<AppState>,
    settings: AppSettings
) -> Result<(), String>;

#[tauri::command]
pub fn get_database_info() -> Result<DatabaseInfo, String>;

#[tauri::command]
pub fn clear_data_before(
    state: State<AppState>,
    before_date: i64
) -> Result<ClearResult, String>;

#[tauri::command]
pub fn get_tracked_apps(state: State<AppState>) -> Result<Vec<AppSetting>, String>;
```

### 3.4 UI å¸ƒå±€

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Settings                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â”‚ General   â”‚ â”‚ Theme                         â”‚  â”‚
â”‚ â”‚ Tracking  â”‚ â”‚ [Light â–¼]                     â”‚  â”‚
â”‚ â”‚ Colors    â”‚ â”‚                               â”‚  â”‚
â”‚ â”‚ Data      â”‚ â”‚ Start on Login                â”‚  â”‚
â”‚ â”‚ About     â”‚ â”‚ [Toggle]                      â”‚  â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚                               â”‚  â”‚
â”‚               â”‚ Close Action                  â”‚  â”‚
â”‚               â”‚ â—‹ Minimize to tray            â”‚  â”‚
â”‚               â”‚ â—‹ Ask every time              â”‚  â”‚
â”‚               â”‚ â—‹ Quit application            â”‚  â”‚
â”‚               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 4. é¢œè‰²é€‰æ‹©å™¨ç»„ä»¶

### 4.1 åŠŸèƒ½æ¦‚è¿°

ä¸€ä¸ªå¯å¤ç”¨çš„é¢œè‰²é€‰æ‹©å™¨ç»„ä»¶ï¼Œç”¨äºä¿®æ”¹åº”ç”¨é¢œè‰²ã€‚

### 4.2 ç»„ä»¶è®¾è®¡

```typescript
// src/components/ui/ColorPicker.tsx

interface ColorPickerProps {
  color: string;
  onChange: (color: string) => void;
  presets?: string[];
}

// é¢„è®¾é¢œè‰²
const DEFAULT_PRESETS = [
  "#ef4444",
  "#f97316",
  "#f59e0b",
  "#eab308",
  "#84cc16",
  "#22c55e",
  "#10b981",
  "#14b8a6",
  "#06b6d4",
  "#0ea5e9",
  "#3b82f6",
  "#6366f1",
  "#8b5cf6",
  "#a855f7",
  "#d946ef",
  "#ec4899",
];
```

### 4.3 UI è®¾è®¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆ     â”‚  <- é¢„è®¾é¢œè‰²
â”‚ â–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆ     â”‚
â”‚                         â”‚
â”‚ Custom: [#3b82f6    ]   â”‚  <- è‡ªå®šä¹‰è¾“å…¥
â”‚                         â”‚
â”‚ Preview: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     â”‚  <- é¢„è§ˆ
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 5. å®ç°é¡ºåº

æŒ‰ä»¥ä¸‹é¡ºåºå®ç°åŠŸèƒ½ï¼š

1. **é¢œè‰²é€‰æ‹©å™¨ç»„ä»¶** (åŸºç¡€ç»„ä»¶ï¼Œè¢«å…¶ä»–åŠŸèƒ½ä¾èµ–)
2. **è®¾ç½®é¡µé¢å®Œå–„** (åŒ…å«é¢œè‰²ç®¡ç†)
3. **çª—å£æœ€å°åŒ–åˆ°æ‰˜ç›˜** (æ”¹è¿›ç”¨æˆ·ä½“éªŒ)
4. **æ•°æ®å¯¼å‡ºåŠŸèƒ½** (å®Œå–„æ•°æ®ç®¡ç†)

---

## 6. éªŒæ”¶æ ‡å‡†

### 6.1 æ•°æ®å¯¼å‡º

- [ ] ç”¨æˆ·å¯ä»¥é€‰æ‹©æ—¥æœŸèŒƒå›´å¯¼å‡ºæ•°æ®
- [ ] æ”¯æŒ CSV å’Œ JSON ä¸¤ç§æ ¼å¼
- [ ] å¯¼å‡ºçš„æ–‡ä»¶å¯ä»¥æ­£å¸¸æ‰“å¼€å’Œè§£æ
- [ ] å¯¼å‡ºè¿‡ç¨‹ä¸­æ˜¾ç¤ºè¿›åº¦/å®Œæˆæç¤º

### 6.2 æœ€å°åŒ–åˆ°æ‰˜ç›˜

- [ ] ç‚¹å‡»å…³é—­æŒ‰é’®æ—¶çª—å£éšè—è€Œéé€€å‡º
- [ ] æ‰˜ç›˜å›¾æ ‡ç‚¹å‡»å¯ä»¥æ¢å¤çª—å£
- [ ] æ‰˜ç›˜èœå•æœ‰"çœŸæ­£é€€å‡º"é€‰é¡¹
- [ ] åå°è¿½è¸ªç»§ç»­æ­£å¸¸è¿è¡Œ

### 6.3 è®¾ç½®é¡µé¢

- [ ] æ‰€æœ‰è®¾ç½®é¡¹å¯ä»¥æ­£å¸¸ä¿®æ”¹å’Œä¿å­˜
- [ ] è®¾ç½®æ›´æ”¹ç«‹å³ç”Ÿæ•ˆ
- [ ] åº”ç”¨é¢œè‰²å¯ä»¥ä¿®æ”¹
- [ ] æ•°æ®æ¸…ç†åŠŸèƒ½æ­£å¸¸å·¥ä½œ

---

_æ–‡æ¡£æœ€åæ›´æ–°: 2026-01-01_
